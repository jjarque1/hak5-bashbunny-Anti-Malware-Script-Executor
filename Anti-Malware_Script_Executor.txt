#!/bin/bash
# Title: Anti-Malware Script Executor
# Description: Run a basic malware detection script and highlight suspicious files and processes.
# Author: jjarque1
# Target: Windows
# Payload developed for educational purposes only
# Don't forget to change the default routes for the target machine routes on lines 24, 26 and 30

# Set HID and storage attack modes
ATTACKMODE HID STORAGE

# Open PowerShell as administrator
QUACK GUI r
QUACK DELAY 500
QUACK STRING powershell Start-Process powershell -Verb runAs
QUACK ENTER
QUACK DELAY 1000

# Confirm admin privileges if UAC is enabled
QUACK ALT y
QUACK DELAY 1000

# Execute a basic malware check using PowerShell commands
QUACK STRING Get-Process | Where-Object { $_.Name -like '*malicious*' } > C:\\Users\\Public\\Documents\\malware_report.txt
QUACK ENTER
QUACK STRING Get-ChildItem C:\\ -Recurse -ErrorAction SilentlyContinue | Where-Object { $_.Name -match 'malware' } >> C:\\Users\\Public\\Documents\\malware_report.txt
QUACK ENTER

# Copy the malware report to the Bash Bunny storage
QUACK STRING copy C:\\Users\\Public\\Documents\\malware_report.txt E:\\malware_report.txt
QUACK ENTER
QUACK DELAY 1000

# Exit PowerShell
QUACK STRING exit
QUACK ENTER

# Eject the USB Bash Bunny
ATTACKMODE OFF
